
include("PJSgroundMotions.jl")
# using PJSgroundMotions


function PJSbssa2014refPGA(M::Float64, Rjb::Float64, Fss::Int64, Fnm::Int64, Frv::Int64, Fuk::Int64, anelasticRegion::String="Global")

    # coefficients for PGAr
    e0 = 0.4473
    e1 = 0.4856
    e2 = 0.2459
    e3 = 0.4539
    e4 = 1.431
    e5 = 0.05053
    e6 = -0.1662
    Mh = 5.5
    c1 = -1.134
    c2 = 0.1917
    c3 = -0.008088
    Mref = 4.5
    Rref = 1.0
    h = 4.5
    Δc3_globalCATWNZ = 0.0
    Δc3_ChinaTurkey = 0.0028576
    Δc3_ItalyJapan = -0.00255

    # source scaling
    FE = e0*Fuk + e1*Fss + e2*Fnm + e3*Frv
    if M <= Mh
        FE += e4*(M - Mh) + e5*(M - Mh)^2
    else
        FE += e6*(M - Mh)
    end

    # path scaling
    # regionalised anelastic attenuation
    if anelasticRegion == "China"
        Δc3 = Δc3_ChinaTurkey
    elseif anelasticRegion == "Turkey"
        Δc3 = Δc3_ChinaTurkey
    elseif anelasticRegion == "Italy"
        Δc3 = Δc3_ItalyJapan
    elseif anelasticRegion == "Japan"
        Δc3 = Δc3_ItalyJapan
    else # Δc3_globalCATWNZ
        Δc3 = Δc3_globalCATWNZ
    end
    R = sqrt(Rjb^2 + h^2)
    FP = (c1 + c2*(M - Mref)) * log(R/Rref) + (c3+Δc3)*(R - Rref)

    # overall source and path effects (all site response terms are nil as they are relative to the reference 760m/s horizon)
    lnPGAr = FE + FP
    PGAr = exp(lnPGAr)

    return PGAr
end

@time PJSbssa2014refPGA( 7.0, 10.0, 1, 0, 0, 0 )


function PJSbssa2014( T::U, M::U, Rjb::U, Fss::Int64, Fnm::Int64, Frv::Int64, Fuk::Int64, Vs30::U, Z1p0::U, region::String="Global" ) where U <: Real
    # coefficients
    Ti = [ -1.0, 0.0, 0.01, 0.02, 0.022, 0.025, 0.029, 0.03, 0.032, 0.035, 0.036, 0.04, 0.042, 0.044, 0.045, 0.046, 0.048, 0.05, 0.055, 0.06, 0.065, 0.067, 0.07, 0.075, 0.08, 0.085, 0.09, 0.095, 0.1, 0.11, 0.12, 0.13, 0.133, 0.14, 0.15, 0.16, 0.17, 0.18, 0.19, 0.2, 0.22, 0.24, 0.25, 0.26, 0.28, 0.29, 0.3, 0.32, 0.34, 0.35, 0.36, 0.38, 0.4, 0.42, 0.44, 0.45, 0.46, 0.48, 0.5, 0.55, 0.6, 0.65, 0.667, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 1.0, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.2, 2.4, 2.5, 2.6, 2.8, 3.0, 3.2, 3.4, 3.5, 3.6, 3.8, 4.0, 4.2, 4.4, 4.6, 4.8, 5.0, 5.5, 6.0, 6.5, 7.0, 7.5, 8.0, 8.5, 9.0, 9.5, 10.0 ]
    e0 = [ 5.037, 0.4473, 0.4534, 0.48598, 0.49866, 0.52283, 0.55949, 0.56916, 0.58802, 0.61636, 0.62554, 0.66281, 0.68087, 0.69882, 0.70822, 0.71779, 0.73574, 0.75436, 0.7996, 0.84394, 0.88655, 0.9027, 0.92652, 0.96447, 1.0003, 1.034, 1.0666, 1.0981, 1.1268, 1.1785, 1.223, 1.2596, 1.2692, 1.2883, 1.3095, 1.3235, 1.3306, 1.3327, 1.3307, 1.3255, 1.3091, 1.2881, 1.2766, 1.2651, 1.2429, 1.2324, 1.2217, 1.2007, 1.179, 1.1674, 1.1558, 1.1305, 1.1046, 1.0782, 1.0515, 1.0376, 1.0234, 0.99719, 0.96991, 0.9048, 0.84165, 0.78181, 0.76262, 0.72513, 0.66903, 0.61346, 0.55853, 0.50296, 0.44701, 0.3932, 0.28484, 0.1734, 0.06152, -0.04575, -0.14954, -0.2486, -0.34145, -0.42975, -0.51276, -0.58669, -0.72143, -0.8481, -0.90966, -0.96863, -1.0817, -1.1898, -1.2914, -1.386, -1.4332, -1.4762, -1.5617, -1.6388, -1.7116, -1.7798, -1.8469, -1.9063, -1.966, -2.1051, -2.2421, -2.3686, -2.4827, -2.5865, -2.6861, -2.782, -2.8792, -2.9769, -3.0702 ]
    e1 = [ 5.078, 0.4856, 0.4916, 0.52359, 0.53647, 0.5613, 0.59923, 0.6092, 0.62875, 0.65818, 0.66772, 0.70604, 0.72443, 0.74277, 0.75232, 0.76202, 0.78015, 0.79905, 0.8445, 0.88884, 0.93116, 0.94711, 0.97057, 1.0077, 1.0426, 1.0755, 1.1076, 1.1385, 1.1669, 1.2179, 1.2621, 1.2986, 1.3082, 1.327, 1.3481, 1.3615, 1.3679, 1.3689, 1.3656, 1.359, 1.3394, 1.315, 1.3017, 1.2886, 1.2635, 1.2517, 1.2401, 1.2177, 1.1955, 1.1836, 1.172, 1.1468, 1.1214, 1.0955, 1.0697, 1.0562, 1.0426, 1.0172, 0.99106, 0.9283, 0.86715, 0.80876, 0.78994, 0.75302, 0.69737, 0.64196, 0.58698, 0.53136, 0.47541, 0.4218, 0.31374, 0.20259, 0.09106, -0.0157, -0.11866, -0.21672, -0.3084, -0.39558, -0.47731, -0.55003, -0.6822, -0.8069, -0.86765, -0.92577, -1.0367, -1.142, -1.2406, -1.3322, -1.3778, -1.4193, -1.5014, -1.5748, -1.6439, -1.7089, -1.7731, -1.8303, -1.8882, -2.0232, -2.1563, -2.2785, -2.3881, -2.4874, -2.5829, -2.6752, -2.7687, -2.8634, -2.9537 ]
    e2 = [ 4.849, 0.2459, 0.2519, 0.29707, 0.31347, 0.34426, 0.39146, 0.40391, 0.42788, 0.46252, 0.47338, 0.51532, 0.53445, 0.55282, 0.56222, 0.57166, 0.58888, 0.60652, 0.6477, 0.68562, 0.71941, 0.73171, 0.7494, 0.77678, 0.80161, 0.82423, 0.84591, 0.86703, 0.8871, 0.92702, 0.96616, 1.0031, 1.0135, 1.036, 1.0648, 1.0876, 1.104, 1.1149, 1.1208, 1.122, 1.1133, 1.0945, 1.0828, 1.071, 1.0476, 1.0363, 1.0246, 1.0011, 0.97677, 0.9638, 0.9512, 0.9244, 0.89765, 0.87067, 0.84355, 0.82941, 0.81509, 0.7886, 0.7615, 0.6984, 0.63875, 0.58231, 0.56422, 0.52878, 0.47523, 0.42173, 0.36813, 0.31376, 0.25919, 0.207, 0.10182, -0.006195, -0.11345, -0.2155, -0.3138, -0.40682, -0.49295, -0.57388, -0.64899, -0.71466, -0.83003, -0.9326, -0.98228, -1.0313, -1.1301, -1.23, -1.3255, -1.415, -1.4599, -1.5014, -1.5865, -1.6673, -1.7451, -1.8192, -1.8923, -1.9573, -2.0245, -2.1908, -2.3659, -2.5322, -2.6818, -2.8176, -2.9438, -3.0597, -3.1713, -3.2785, -3.3776 ]
    e3 = [ 5.033, 0.4539, 0.4599, 0.48875, 0.49973, 0.51999, 0.54995, 0.55783, 0.5733, 0.59704, 0.60496, 0.63828, 0.65505, 0.67225, 0.68139, 0.69076, 0.70854, 0.72726, 0.7737, 0.82067, 0.86724, 0.88526, 0.91227, 0.9563, 0.99818, 1.0379, 1.0762, 1.1127, 1.1454, 1.203, 1.2502, 1.2869, 1.2961, 1.3137, 1.3324, 1.3437, 1.3487, 1.3492, 1.3463, 1.3414, 1.3281, 1.3132, 1.3052, 1.2972, 1.2815, 1.2736, 1.2653, 1.2479, 1.2286, 1.2177, 1.2066, 1.1816, 1.1552, 1.1276, 1.0995, 1.0847, 1.0696, 1.0415, 1.012, 0.9417, 0.87351, 0.80948, 0.78916, 0.74985, 0.69173, 0.63519, 0.57969, 0.52361, 0.46706, 0.4124, 0.30209, 0.18866, 0.07433, -0.03607, -0.1437, -0.24708, -0.34465, -0.43818, -0.52682, -0.60658, -0.75402, -0.8941, -0.96187, -1.0266, -1.1495, -1.2664, -1.376, -1.4786, -1.5297, -1.5764, -1.6685, -1.7516, -1.829, -1.9011, -1.9712, -2.0326, -2.0928, -2.2288, -2.3579, -2.477, -2.5854, -2.6854, -2.7823, -2.8776, -2.9759, -3.076, -3.1726 ]
    e4 = [ 1.073, 1.431, 1.421, 1.4331, 1.4336, 1.4328, 1.4279, 1.4261, 1.4227, 1.4174, 1.4158, 1.409, 1.4059, 1.4033, 1.4021, 1.4009, 1.3991, 1.3974, 1.3947, 1.3954, 1.4004, 1.4032, 1.4082, 1.4174, 1.4261, 1.4322, 1.435, 1.4339, 1.4293, 1.411, 1.3831, 1.3497, 1.3395, 1.3162, 1.2844, 1.2541, 1.2244, 1.1941, 1.1635, 1.1349, 1.0823, 1.0366, 1.0166, 0.99932, 0.97282, 0.96348, 0.95676, 0.95004, 0.94956, 0.95077, 0.95278, 0.95899, 0.96766, 0.97862, 0.99144, 0.99876, 1.0064, 1.0215, 1.0384, 1.0833, 1.1336, 1.1861, 1.2035, 1.2375, 1.2871, 1.3341, 1.378, 1.4208, 1.4623, 1.5004, 1.569, 1.6282, 1.6794, 1.7239, 1.7622, 1.7955, 1.8259, 1.8564, 1.8868, 1.9152, 1.9681, 2.017, 2.0406, 2.0628, 2.1014, 2.1323, 2.1545, 2.1704, 2.1775, 2.1834, 2.1938, 2.204, 2.2123, 2.2181, 2.223, 2.2268, 2.2299, 2.2389, 2.2377, 2.215, 2.172, 2.1187, 2.0613, 2.0084, 1.9605, 1.9189, 1.8837 ]
    e5 = [ -0.1536, 0.05053, 0.04932, 0.053388, 0.054888, 0.057529, 0.060732, 0.061444, 0.062806, 0.064559, 0.065028, 0.066183, 0.066438, 0.066663, 0.066774, 0.066891, 0.067127, 0.067357, 0.067797, 0.068591, 0.070127, 0.070895, 0.072075, 0.073549, 0.073735, 0.07194, 0.068097, 0.062327, 0.055231, 0.037389, 0.016373, -0.005158, -0.011354, -0.024711, -0.042065, -0.057593, -0.071861, -0.08564, -0.098884, -0.11096, -0.133, -0.15299, -0.16213, -0.17041, -0.18463, -0.19057, -0.1959, -0.20454, -0.21134, -0.21446, -0.21716, -0.22214, -0.22608, -0.22924, -0.23166, -0.23263, -0.2335, -0.23464, -0.23522, -0.23449, -0.23128, -0.22666, -0.22497, -0.22143, -0.21591, -0.21047, -0.20528, -0.20011, -0.1949, -0.18983, -0.18001, -0.1709, -0.16233, -0.15413, -0.1467, -0.13997, -0.13361, -0.12686, -0.11959, -0.11237, -0.098017, -0.083765, -0.076308, -0.068925, -0.055229, -0.04332, -0.03444, -0.027889, -0.024997, -0.022575, -0.018362, -0.014642, -0.012248, -0.011459, -0.01176, -0.012879, -0.014855, -0.019502, -0.026383, -0.039505, -0.05914, -0.081606, -0.10382, -0.12114, -0.13407, -0.14364, -0.15096 ]
    e6 = [ 0.2252, -0.1662, -0.1659, -0.16561, -0.1652, -0.16499, -0.16632, -0.1669, -0.16813, -0.17015, -0.17083, -0.17357, -0.17485, -0.17619, -0.17693, -0.17769, -0.1792, -0.18082, -0.1848, -0.18858, -0.19176, -0.19291, -0.19451, -0.19665, -0.19816, -0.19902, -0.19929, -0.199, -0.19838, -0.19601, -0.19265, -0.18898, -0.18792, -0.18566, -0.18234, -0.17853, -0.17421, -0.16939, -0.16404, -0.15852, -0.14704, -0.13445, -0.12784, -0.12115, -0.10714, -0.10011, -0.092855, -0.078923, -0.065134, -0.057921, -0.05104, -0.036755, -0.023189, -0.010417, 0.0011678, 0.0065887, 0.011871, 0.020767, 0.029119, 0.046932, 0.062667, 0.077997, 0.083058, 0.093185, 0.10829, 0.12256, 0.13608, 0.14983, 0.16432, 0.17895, 0.21042, 0.2441, 0.27799, 0.30956, 0.33896, 0.36616, 0.39065, 0.41244, 0.43151, 0.44788, 0.48024, 0.51873, 0.53883, 0.5581, 0.59394, 0.62694, 0.65811, 0.68755, 0.70216, 0.71523, 0.74028, 0.76303, 0.78552, 0.80792, 0.83126, 0.8524, 0.87314, 0.91466, 0.9487, 0.97643, 0.99757, 1.0121, 1.0232, 1.0335, 1.0453, 1.0567, 1.0651 ]
    Mh = [ 6.2, 5.5, 5.5, 5.5, 5.5, 5.5, 5.5, 5.5, 5.5, 5.5, 5.5, 5.5, 5.5, 5.5, 5.5, 5.5, 5.5, 5.5, 5.5, 5.5, 5.5, 5.5, 5.5, 5.5, 5.5, 5.51, 5.52, 5.53, 5.54, 5.57, 5.62, 5.66, 5.67, 5.7, 5.74, 5.78, 5.82, 5.85, 5.89, 5.92, 5.97, 6.03, 6.05, 6.07, 6.11, 6.12, 6.14, 6.16, 6.18, 6.18, 6.19, 6.19, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2, 6.2 ]
    c1 = [ -1.243, -1.134, -1.134, -1.1394, -1.1405, -1.1419, -1.1423, -1.1421, -1.1412, -1.1388, -1.1378, -1.1324, -1.1292, -1.1259, -1.1242, -1.1224, -1.1192, -1.1159, -1.1082, -1.1009, -1.0942, -1.0918, -1.0884, -1.0831, -1.0785, -1.0745, -1.0709, -1.0678, -1.0652, -1.0607, -1.0572, -1.0549, -1.0545, -1.0537, -1.0532, -1.0533, -1.0541, -1.0556, -1.0579, -1.0607, -1.067, -1.0737, -1.0773, -1.0808, -1.0879, -1.0913, -1.0948, -1.1013, -1.1074, -1.1105, -1.1133, -1.119, -1.1243, -1.1291, -1.1337, -1.1359, -1.1381, -1.142, -1.1459, -1.1543, -1.1615, -1.1676, -1.1694, -1.1728, -1.1777, -1.1819, -1.1854, -1.1884, -1.1909, -1.193, -1.1966, -1.1996, -1.2018, -1.2039, -1.2063, -1.2086, -1.2106, -1.2123, -1.2141, -1.2159, -1.219, -1.2202, -1.2201, -1.2198, -1.2189, -1.2179, -1.2169, -1.216, -1.2156, -1.2156, -1.2158, -1.2162, -1.2165, -1.2169, -1.2175, -1.2182, -1.2189, -1.2204, -1.2232, -1.2299, -1.2408, -1.2543, -1.2688, -1.2839, -1.2989, -1.313, -1.3253 ]
    c2 = [ 0.1489, 0.1917, 0.1916, 0.18962, 0.18924, 0.18875, 0.18844, 0.18842, 0.1884, 0.18839, 0.18837, 0.18816, 0.18797, 0.18775, 0.18764, 0.18752, 0.1873, 0.18709, 0.18655, 0.18582, 0.18485, 0.18442, 0.18369, 0.18225, 0.18052, 0.17856, 0.17643, 0.1742, 0.17203, 0.1677, 0.16352, 0.15982, 0.15882, 0.15672, 0.15401, 0.15158, 0.14948, 0.14768, 0.14616, 0.14489, 0.14263, 0.14035, 0.13925, 0.13818, 0.13604, 0.13499, 0.13388, 0.13179, 0.12984, 0.1289, 0.12806, 0.12647, 0.12512, 0.12389, 0.12278, 0.12227, 0.12177, 0.12093, 0.12015, 0.11847, 0.11671, 0.11465, 0.11394, 0.11253, 0.11054, 0.10873, 0.10709, 0.10548, 0.10389, 0.10248, 0.10016, 0.098482, 0.097375, 0.096743, 0.096445, 0.096338, 0.096254, 0.096207, 0.096255, 0.096361, 0.096497, 0.096198, 0.096106, 0.096136, 0.096667, 0.097638, 0.098649, 0.099553, 0.099989, 0.10043, 0.10142, 0.10218, 0.10269, 0.10304, 0.10324, 0.10337, 0.10353, 0.1046, 0.1075, 0.11231, 0.11853, 0.12507, 0.13146, 0.13742, 0.14294, 0.14781, 0.15183 ]
    c3 = [ -0.00344, -0.008088, -0.008088, -0.008074, -0.008095, -0.008153, -0.00829, -0.008336, -0.008445, -0.008642, -0.008715, -0.00903, -0.009195, -0.00936, -0.009441, -0.009521, -0.009676, -0.009819, -0.01012, -0.01033, -0.01048, -0.01052, -0.01056, -0.01058, -0.01056, -0.01051, -0.01042, -0.01032, -0.0102, -0.009964, -0.009722, -0.009476, -0.009402, -0.009228, -0.008977, -0.008725, -0.008472, -0.008219, -0.007967, -0.007717, -0.007224, -0.006747, -0.006517, -0.006293, -0.005866, -0.005666, -0.005475, -0.005122, -0.004808, -0.004663, -0.004527, -0.004276, -0.004053, -0.003853, -0.003673, -0.00359, -0.00351, -0.00336, -0.00322, -0.002897, -0.00261, -0.002356, -0.002276, -0.002131, -0.001931, -0.001754, -0.001597, -0.001456, -0.001328, -0.00121, -0.000994, -0.000803, -0.000635, -0.00049, -0.000365, -0.000259, -0.000171, -0.000099, -0.000042, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.000023, -0.00004, -0.000045, -0.000049, -0.000053, -0.000052, -0.000047, -0.000039, -0.000027, -0.000014, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ]
    Mref = [ 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5 ]
    Rref = [ 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0 ]
    h = [ 5.3, 4.5, 4.5, 4.5, 4.5, 4.5, 4.5, 4.49, 4.45, 4.4, 4.38, 4.32, 4.29, 4.27, 4.25, 4.24, 4.22, 4.2, 4.15, 4.11, 4.08, 4.07, 4.06, 4.04, 4.02, 4.03, 4.07, 4.1, 4.13, 4.19, 4.24, 4.29, 4.3, 4.34, 4.39, 4.44, 4.49, 4.53, 4.57, 4.61, 4.68, 4.75, 4.78, 4.82, 4.88, 4.9, 4.93, 4.98, 5.03, 5.06, 5.08, 5.12, 5.16, 5.2, 5.24, 5.25, 5.27, 5.3, 5.34, 5.41, 5.48, 5.53, 5.54, 5.56, 5.6, 5.63, 5.66, 5.69, 5.72, 5.74, 5.82, 5.92, 6.01, 6.1, 6.18, 6.26, 6.33, 6.4, 6.48, 6.54, 6.66, 6.73, 6.77, 6.81, 6.87, 6.93, 6.99, 7.08, 7.12, 7.16, 7.24, 7.32, 7.39, 7.46, 7.52, 7.64, 7.78, 8.07, 8.48, 8.9, 9.2, 9.48, 9.57, 9.62, 9.66, 9.66, 9.66 ]
    Δc3_globalCATWNZ = [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ]
    Δc3_ChinaTurkey = [ 0.004345, 0.0028576, 0.0028159, 0.0027795, 0.0027597, 0.0027542, 0.0027616, 0.0027646, 0.0027691, 0.0027837, 0.002801, 0.0028219, 0.0028465, 0.0028738, 0.0029002, 0.0029229, 0.0029439, 0.0029566, 0.0029639, 0.0029675, 0.0029684, 0.0029675, 0.0029639, 0.0029566, 0.0029448, 0.0029302, 0.0029138, 0.0028965, 0.0028792, 0.0028629, 0.0028465, 0.002831, 0.0028165, 0.0028019, 0.0027864, 0.0027646, 0.0027336, 0.0026991, 0.0026599, 0.0026117, 0.0025598, 0.0025052, 0.0024443, 0.0023797, 0.0023141, 0.0022504, 0.0021958, 0.0021549, 0.0021239, 0.0021039, 0.0020966, 0.0020976, 0.0021067, 0.0021267, 0.0021603, 0.0022022, 0.0022495, 0.0022978, 0.0023478, 0.0023988, 0.0024515, 0.002508, 0.002568, 0.002629, 0.00269, 0.0027464, 0.0027973, 0.0028428, 0.0028847, 0.0029211, 0.0029539, 0.0029821, 0.0030066, 0.0030258, 0.0030394, 0.0030412, 0.0030258, 0.0030003, 0.0029675, 0.0029229, 0.0028701, 0.0028146, 0.0027609, 0.0027082, 0.0026581, 0.0026163, 0.002588, 0.0025753, 0.0025717, 0.0025735, 0.0025862, 0.0026053, 0.002619, 0.0026235, 0.0026217, 0.0026153, 0.0026035, 0.0025908, 0.0025835, 0.0025862, 0.0026026, 0.0026, 0.00263, 0.00267, 0.00276, 0.00289, 0.00303 ]
    Δc3_ItalyJapan = [ -0.00033, -0.00255, -0.0024367, -0.00234, -0.0022886, -0.00225, -0.0022145, -0.0021676, -0.0021167, -0.0020957, -0.0020748, -0.0020539, -0.0020348, -0.0020157, -0.0020011, -0.0019929, -0.0019884, -0.0019911, -0.0020011, -0.0020193, -0.0020448, -0.0020766, -0.0021148, -0.0021594, -0.0022122, -0.0022695, -0.0023269, -0.0023833, -0.0024388, -0.0024916, -0.0025398, -0.0025844, -0.0026263, -0.0026663, -0.0027063, -0.0027509, -0.0028019, -0.0028547, -0.0029111, -0.0029702, -0.0030285, -0.0030849, -0.0031395, -0.0031896, -0.0032351, -0.0032742, -0.0032969, -0.0033033, -0.0032997, -0.0032869, -0.0032669, -0.0032423, -0.0032123, -0.0031768, -0.0031322, -0.0030794, -0.0030212, -0.0029639, -0.0029065, -0.0028483, -0.0027892, -0.0027273, -0.0026618, -0.0025953, -0.0025271, -0.0024561, -0.0023787, -0.0022932, -0.0021958, -0.0020894, -0.0019774, -0.0018619, -0.0017454, -0.0016298, -0.0015179, -0.0014114, -0.0013231, -0.0012531, -0.0012012, -0.0011703, -0.0011566, -0.0011548, -0.0011593, -0.0011684, -0.0011803, -0.0011885, -0.0011921, -0.0011866, -0.0011739, -0.0011539, -0.0011229, -0.0010829, -0.0010247, -0.0009464, -0.00084448, -0.00071799, -0.00057148, -0.00040768, -0.00022841, -0.0000364, 0.00016835, 0.00038493, 0.00072, 0.00094, 0.00113, 0.00131, 0.00149 ]
    c = [ -0.84, -0.6, -0.60372, -0.57388, -0.56675, -0.5552, -0.5385, -0.53414, -0.52529, -0.51192, -0.50752, -0.49065, -0.4829, -0.47572, -0.47236, -0.46915, -0.46321, -0.45795, -0.44787, -0.44186, -0.43951, -0.4395, -0.4404, -0.44411, -0.4502, -0.45813, -0.46732, -0.47721, -0.48724, -0.50632, -0.52438, -0.54214, -0.54752, -0.56032, -0.57962, -0.60052, -0.62252, -0.64486, -0.66681, -0.68762, -0.72431, -0.75646, -0.77177, -0.78697, -0.81613, -0.8295, -0.84165, -0.86175, -0.87726, -0.88375, -0.88965, -0.90038, -0.91092, -0.92241, -0.93459, -0.94075, -0.94686, -0.95863, -0.9693, -0.98925, -1.0012, -1.0078, -1.0093, -1.0117, -1.0154, -1.021, -1.0282, -1.036, -1.0436, -1.05, -1.0573, -1.0584, -1.0554, -1.0504, -1.0454, -1.0421, -1.0404, -1.0397, -1.0395, -1.0392, -1.0368, -1.0323, -1.0294, -1.0262, -1.019, -1.0112, -1.0032, -0.99512, -0.991, -0.98682, -0.97826, -0.96938, -0.96012, -0.95049, -0.9405, -0.93018, -0.91954, -0.89176, -0.86286, -0.83355, -0.80457, -0.77665, -0.75033, -0.72544, -0.70161, -0.6785, -0.65575 ]
    Vc = [ 1300.0, 1500.0, 1500.2, 1500.36, 1500.68, 1501.04, 1501.26, 1502.95, 1503.12, 1503.24, 1503.32, 1503.35, 1503.34, 1503.13, 1502.84, 1502.47, 1502.01, 1501.42, 1500.71, 1499.83, 1498.74, 1497.42, 1495.85, 1494, 1491.82, 1489.29, 1486.36, 1482.98, 1479.12, 1474.74, 1469.75, 1464.09, 1457.76, 1450.71, 1442.85, 1434.22, 1424.85, 1414.77, 1403.99, 1392.61, 1380.72, 1368.51, 1356.21, 1343.89, 1331.67, 1319.83, 1308.47, 1297.65, 1287.5, 1278.06, 1269.19, 1260.74, 1252.66, 1244.8, 1237.03, 1229.23, 1221.16, 1212.74, 1203.91, 1194.59, 1184.93, 1175.19, 1165.69, 1156.46, 1147.59, 1139.21, 1131.34, 1123.91, 1116.83, 1109.95, 1103.07, 1096.04, 1088.67, 1080.77, 1072.39, 1061.77, 1049.29, 1036.42, 1023.14, 1009.49, 995.52, 981.33, 966.94, 952.34, 937.52, 922.43, 908.79, 896.15, 883.16, 870.05, 857.07, 844.48, 832.45, 821.18, 810.79, 801.41, 793.13, 785.73, 779.91, 775.6, 772.68, 771.01, 760.81, 764.5, 768.07, 771.55, 775.0 ]
    Vref = [ 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0, 760.0 ]
    f1 = [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ]
    f3 = [ 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1 ]
    f4 = [ -0.1, -0.15, -0.14833, -0.1471, -0.14801, -0.15015, -0.15387, -0.15485, -0.15685, -0.16016, -0.16142, -0.16777, -0.17193, -0.17664, -0.17914, -0.1817, -0.18688, -0.192, -0.20369, -0.21374, -0.22225, -0.22524, -0.22931, -0.235, -0.23944, -0.24285, -0.24544, -0.24747, -0.24916, -0.25213, -0.25455, -0.25628, -0.25665, -0.25719, -0.25713, -0.25604, -0.25414, -0.25173, -0.24911, -0.24658, -0.24235, -0.23823, -0.23574, -0.2328, -0.22601, -0.2225, -0.21912, -0.21318, -0.20816, -0.20592, -0.20379, -0.19978, -0.19582, -0.19171, -0.18747, -0.18534, -0.18321, -0.17902, -0.175, -0.16601, -0.1583, -0.15144, -0.14923, -0.14503, -0.13866, -0.13201, -0.12517, -0.11831, -0.1116, -0.10521, -0.093837, -0.084144, -0.075819, -0.068543, -0.062, -0.055927, -0.050286, -0.045096, -0.040373, -0.036136, -0.029105, -0.02371, -0.021509, -0.019576, -0.016324, -0.013577, -0.01103, -0.0086652, -0.0075682, -0.0065374, -0.0047016, -0.0032123, -0.0021033, -0.0013244, -0.00080422, -0.00047145, -0.0002548, 0.000072383, 0.0001877, 0.00015945, 0.00005592, -0.0000546, -0.00011724, -0.00013084, -0.00010766, -0.000059962, 0.0 ]
    f5 = [ -0.00844, -0.00701, -0.00701, -0.00728, -0.00732, -0.00736, -0.00737, -0.00735, -0.00731, -0.00721, -0.00717, -0.00698, -0.00687, -0.00677, -0.00672, -0.00667, -0.00656, -0.00647, -0.00625, -0.00607, -0.00593, -0.00588, -0.00582, -0.00573, -0.00567, -0.00563, -0.00561, -0.0056, -0.0056, -0.00562, -0.00567, -0.00572, -0.00574, -0.00578, -0.00585, -0.00591, -0.00597, -0.00602, -0.00608, -0.00614, -0.00626, -0.00638, -0.00644, -0.0065, -0.0066, -0.00665, -0.0067, -0.0068, -0.00689, -0.00693, -0.00697, -0.00705, -0.00713, -0.00719, -0.00726, -0.00729, -0.00732, -0.00738, -0.00744, -0.00758, -0.00773, -0.00787, -0.00792, -0.008, -0.00812, -0.00822, -0.0083, -0.00836, -0.00841, -0.00844, -0.00847, -0.00842, -0.00829, -0.00806, -0.00771, -0.00723, -0.00666, -0.00603, -0.0054, -0.00479, -0.00378, -0.00302, -0.00272, -0.00246, -0.00208, -0.00183, -0.00167, -0.00158, -0.00155, -0.00154, -0.00152, -0.00152, -0.00152, -0.0015, -0.00148, -0.00146, -0.00144, -0.0014, -0.00138, -0.00137, -0.00137, -0.00137, -0.00137, -0.00137, -0.00137, -0.00136, -0.00136 ]
    f6 = [ -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, 0.0058286, 0.026446, 0.055495, 0.092259, 0.1404, 0.19495, 0.25203, 0.3094, 0.36695, 0.42452, 0.48116, 0.53597, 0.58832, 0.63789, 0.68889, 0.73578, 0.77992, 0.82427, 0.87138, 0.92033, 0.96931, 1.0167, 1.0601, 1.099, 1.1348, 1.1638, 1.1882, 1.2114, 1.2336, 1.2534, 1.2711, 1.287, 1.3004, 1.3125, 1.3225, 1.3289, 1.345, 1.3496, 1.3489, 1.3422, 1.3288, 1.3084, 1.2822, 1.2515, 1.2179, 1.1829 ]
    f7 = [ -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, -9.9, 0.003762, 0.0171, 0.035728, 0.059024, 0.088481, 0.12029, 0.15159, 0.18077, 0.20789, 0.2331, 0.25606, 0.27648, 0.29424, 0.30944, 0.32449, 0.3372, 0.34963, 0.36413, 0.38245, 0.40402, 0.42742, 0.45142, 0.47422, 0.49536, 0.51585, 0.53411, 0.55145, 0.56981, 0.58932, 0.60918, 0.62939, 0.65157, 0.67421, 0.69698, 0.71888, 0.73806, 0.7779, 0.80278, 0.8148, 0.81615, 0.809, 0.79538, 0.77671, 0.75425, 0.72925, 0.703 ]
    R1 = [ 105.0, 110.0, 111.67, 113.1, 113.37, 113.07, 112.36, 112.13, 111.65, 110.64, 109.53, 108.28, 106.99, 105.41, 103.61, 101.7, 99.76, 97.93, 96.03, 94.1, 92.08, 90.01, 87.97, 85.99, 84.23, 82.74, 81.54, 80.46, 79.59, 79.05, 78.85, 78.99, 79.47, 80.26, 81.33, 82.86, 84.72, 86.67, 88.73, 90.91, 93.04, 95.08, 97.04, 98.87, 100.53, 102.01, 103.15, 104, 104.7, 105.26, 105.61, 105.87, 106.02, 106.03, 105.92, 105.79, 105.69, 105.59, 105.54, 105.61, 105.83, 106.2, 106.75, 107.48, 108.39, 109.62, 111.08, 112.71, 114.5, 116.39, 118.3, 120.19, 122.01, 123.75, 125.38, 126.9, 128.14, 129.11, 129.86, 130.37, 130.67, 130.81, 130.81, 130.72, 130.57, 130.36, 130.13, 129.9, 129.71, 129.56, 129.49, 129.49, 129.57, 129.71, 129.87, 130.05, 130.22, 130.39, 130.53, 130.63, 130.7, 130.72, 130.87, 130.71, 130.5, 130.26, 130.0 ]
    R2 = [ 272.0, 270.0, 270.0, 270.0, 270.0, 270.0, 270.0, 270.0, 270.0, 270.0, 270.0, 270.0, 270.0, 270.0, 270.0, 270.0, 270.0, 270.0, 270.0, 270.01, 270.02, 270.02, 270.03, 270.04, 270.05, 270.06, 270.07, 270.08, 270.09, 270.11, 270.13, 270.15, 270.15, 270.16, 270.16, 270.16, 270.14, 270.11, 270.06, 270.0, 269.83, 269.59, 269.45, 269.3, 268.96, 268.78, 268.59, 268.2, 267.79, 267.58, 267.37, 266.95, 266.54, 266.16, 265.8, 265.64, 265.48, 265.21, 265.0, 264.74, 264.83, 265.2, 265.38, 265.78, 266.51, 267.32, 268.14, 268.9, 269.55, 270.0, 270.18, 269.42, 267.82, 265.45, 262.41, 258.78, 254.66, 250.11, 245.25, 240.14, 229.55, 219.05, 214.04, 209.32, 201.08, 195.0, 191.61, 190.73, 191.11, 191.98, 195.01, 199.45, 204.93, 211.09, 217.56, 223.99, 230.0, 241.86, 249.34, 252.94, 253.12, 250.39, 245.23, 238.13, 229.56, 220.02, 210.0 ]
    ΔϕR = [ 0.082, 0.1, 0.096, 0.092, 0.088, 0.086, 0.084, 0.081, 0.078, 0.077, 0.075, 0.073, 0.072, 0.07, 0.069, 0.067, 0.065, 0.063, 0.062, 0.061, 0.061, 0.061, 0.062, 0.064, 0.067, 0.072, 0.076, 0.082, 0.087, 0.093, 0.099, 0.104, 0.11, 0.115, 0.12, 0.125, 0.128, 0.131, 0.134, 0.136, 0.138, 0.14, 0.141, 0.141, 0.14, 0.139, 0.138, 0.135, 0.133, 0.13, 0.128, 0.125, 0.122, 0.12, 0.117, 0.115, 0.113, 0.111, 0.109, 0.108, 0.106, 0.105, 0.103, 0.102, 0.1, 0.099, 0.099, 0.098, 0.098, 0.098, 0.099, 0.1, 0.101, 0.102, 0.104, 0.105, 0.106, 0.106, 0.106, 0.105, 0.103, 0.1, 0.097, 0.094, 0.091, 0.088, 0.084, 0.081, 0.078, 0.075, 0.072, 0.07, 0.068, 0.066, 0.064, 0.063, 0.061, 0.06, 0.059, 0.059, 0.059, 0.058, 0.059, 0.059, 0.06, 0.06, 0.06 ]
    ΔϕV = [ 0.08, 0.07, 0.07, 0.03, 0.027, 0.026, 0.028, 0.029, 0.03, 0.031, 0.031, 0.032, 0.032, 0.031, 0.031, 0.031, 0.031, 0.03, 0.029, 0.027, 0.025, 0.025, 0.024, 0.022, 0.02, 0.019, 0.017, 0.016, 0.014, 0.012, 0.011, 0.011, 0.011, 0.012, 0.015, 0.02, 0.026, 0.033, 0.039, 0.045, 0.052, 0.055, 0.055, 0.055, 0.053, 0.051, 0.05, 0.048, 0.047, 0.047, 0.047, 0.048, 0.049, 0.051, 0.053, 0.054, 0.055, 0.057, 0.06, 0.066, 0.071, 0.073, 0.074, 0.073, 0.07, 0.063, 0.053, 0.042, 0.03, 0.02, 0.007, 0.002, 0.003, 0.006, 0.01, 0.012, 0.012, 0.012, 0.01, 0.008, 0.005, 0.003, 0.002, 0.001, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ]
    V1 = [ 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0, 225.0 ]
    V2 = [ 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0 ]
    ϕ1 = [ 0.644, 0.695, 0.698, 0.702, 0.707, 0.711, 0.716, 0.721, 0.726, 0.73, 0.734, 0.738, 0.742, 0.745, 0.748, 0.75, 0.752, 0.753, 0.753, 0.753, 0.752, 0.75, 0.748, 0.745, 0.741, 0.737, 0.734, 0.731, 0.728, 0.726, 0.724, 0.723, 0.722, 0.721, 0.72, 0.72, 0.718, 0.717, 0.714, 0.711, 0.708, 0.703, 0.698, 0.693, 0.687, 0.681, 0.675, 0.67, 0.664, 0.658, 0.653, 0.648, 0.643, 0.638, 0.634, 0.629, 0.624, 0.619, 0.615, 0.61, 0.605, 0.599, 0.593, 0.587, 0.581, 0.576, 0.57, 0.564, 0.558, 0.553, 0.548, 0.543, 0.539, 0.535, 0.532, 0.529, 0.527, 0.526, 0.526, 0.526, 0.527, 0.528, 0.53, 0.531, 0.532, 0.534, 0.535, 0.535, 0.536, 0.536, 0.536, 0.536, 0.535, 0.534, 0.533, 0.531, 0.528, 0.526, 0.524, 0.52, 0.515, 0.512, 0.51, 0.509, 0.509, 0.509, 0.51 ]
    ϕ2 = [ 0.552, 0.495, 0.499, 0.502, 0.505, 0.508, 0.51, 0.514, 0.516, 0.518, 0.52, 0.521, 0.523, 0.525, 0.527, 0.529, 0.53, 0.532, 0.534, 0.536, 0.538, 0.54, 0.541, 0.542, 0.543, 0.543, 0.542, 0.542, 0.541, 0.54, 0.539, 0.538, 0.538, 0.537, 0.537, 0.536, 0.536, 0.536, 0.537, 0.539, 0.541, 0.544, 0.547, 0.55, 0.554, 0.557, 0.561, 0.566, 0.57, 0.573, 0.576, 0.578, 0.58, 0.583, 0.585, 0.589, 0.592, 0.595, 0.599, 0.603, 0.607, 0.611, 0.615, 0.619, 0.622, 0.624, 0.625, 0.626, 0.626, 0.625, 0.624, 0.623, 0.622, 0.62, 0.619, 0.618, 0.618, 0.618, 0.618, 0.618, 0.619, 0.619, 0.619, 0.62, 0.619, 0.619, 0.618, 0.618, 0.617, 0.616, 0.616, 0.616, 0.616, 0.617, 0.619, 0.621, 0.622, 0.624, 0.625, 0.634, 0.636, 0.634, 0.63, 0.622, 0.613, 0.604, 0.604 ]
    τ1 = [ 0.401, 0.398, 0.402, 0.409, 0.418, 0.427, 0.436, 0.445, 0.454, 0.462, 0.47, 0.478, 0.484, 0.49, 0.496, 0.499, 0.502, 0.503, 0.502, 0.499, 0.495, 0.489, 0.483, 0.474, 0.464, 0.452, 0.44, 0.428, 0.415, 0.403, 0.392, 0.381, 0.371, 0.362, 0.354, 0.349, 0.346, 0.344, 0.343, 0.344, 0.345, 0.347, 0.35, 0.353, 0.357, 0.36, 0.363, 0.366, 0.369, 0.372, 0.375, 0.378, 0.381, 0.384, 0.388, 0.393, 0.398, 0.404, 0.41, 0.417, 0.424, 0.431, 0.44, 0.448, 0.457, 0.466, 0.475, 0.483, 0.491, 0.498, 0.505, 0.511, 0.516, 0.521, 0.525, 0.528, 0.53, 0.531, 0.532, 0.532, 0.533, 0.533, 0.534, 0.535, 0.536, 0.537, 0.538, 0.54, 0.541, 0.542, 0.543, 0.543, 0.542, 0.54, 0.538, 0.535, 0.532, 0.528, 0.524, 0.517, 0.514, 0.511, 0.507, 0.503, 0.498, 0.492, 0.487 ]
    τ2 = [ 0.346, 0.348, 0.345, 0.346, 0.349, 0.354, 0.359, 0.364, 0.369, 0.374, 0.379, 0.384, 0.39, 0.397, 0.405, 0.412, 0.419, 0.426, 0.434, 0.441, 0.448, 0.455, 0.461, 0.466, 0.468, 0.468, 0.466, 0.464, 0.458, 0.451, 0.441, 0.43, 0.417, 0.403, 0.388, 0.372, 0.357, 0.341, 0.324, 0.309, 0.294, 0.28, 0.266, 0.255, 0.244, 0.236, 0.229, 0.223, 0.218, 0.215, 0.212, 0.21, 0.21, 0.21, 0.211, 0.213, 0.216, 0.219, 0.224, 0.229, 0.235, 0.243, 0.25, 0.258, 0.266, 0.274, 0.281, 0.288, 0.294, 0.298, 0.302, 0.306, 0.309, 0.312, 0.315, 0.318, 0.321, 0.323, 0.326, 0.329, 0.332, 0.335, 0.337, 0.34, 0.342, 0.344, 0.345, 0.346, 0.347, 0.348, 0.349, 0.349, 0.349, 0.347, 0.345, 0.341, 0.335, 0.329, 0.321, 0.312, 0.302, 0.27, 0.278, 0.265, 0.252, 0.239, 0.239 ]

    # check bounds on the allowable value of T
    if T < 0.0
        # return a prediction for PGV
        tidHI = tidLO = 1
    else
        T = ( T < 10.0 ) ? T : 10.0
        tidHI = findfirst(Ti .>= T)
        tidLO = findlast(Ti .<= T)
    end

    if ( tidLO == tidHI )
        # we have a known period/IM
        tid = tidHI

        # source scaling
        FE = e0[tid]*Fuk + e1[tid]*Fss + e2[tid]*Fnm + e3[tid]*Frv
        if M <= Mh[tid]
            FE += e4[tid]*(M - Mh[tid]) + e5[tid]*(M - Mh[tid])^2
        else
            FE += e6[tid]*(M - Mh[tid])
        end

        # path scaling
        # regionalised anelastic attenuation
        if region == "China"
            Δc3 = Δc3_ChinaTurkey[tid]
        elseif region == "Turkey"
            Δc3 = Δc3_ChinaTurkey[tid]
        elseif region == "Italy"
            Δc3 = Δc3_ItalyJapan[tid]
        elseif region == "Japan"
            Δc3 = Δc3_ItalyJapan[tid]
        else # Δc3_globalCATWNZ
            Δc3 = Δc3_globalCATWNZ[tid]
        end
        R = sqrt(Rjb^2 + h[tid]^2)
        FP = (c1[tid] + c2[tid]*(M - Mref[tid])) * log(R/Rref[tid]) + (c3[tid]+Δc3)*(R - Rref[tid])

        # site scaling
        # linear site response
        lnFlin = ( Vs30 <= Vc[tid] ) ? c[tid]*log(Vs30/Vref[tid]) : c[tid]*log(Vc[tid]/Vref[tid])

        # nonlinear site response
        # need pga_r (median PGA on reference 760 m/s site condition)
        PGAr = PJSbssa2014refPGA(M, Rjb, Fss, Fnm, Frv, Fuk, region)
        # slope of nonlinearity
        f2 = f4[tid]*( exp(f5[tid]*( min(Vs30, 760.0) - 360.0 )) - exp(f5[tid]*(760.0 - 360.0)) )
        lnFnl = f1[tid] + f2 * log((PGAr + f3[tid])/f3[tid])

        # basin depth term
        if region == "California"
            μz1 = exp( (-7.15/4.0)*log( (Vs30^4 + 570.94^4)/(1360.0^4 + 570.94^4) ) - log(1000.0) )
            δz1 = Z1p0 - μz1
        elseif region == "Japan"
            μz1 = exp( (-5.23/2.0)*log( (Vs30^2 + 412.39^2)/(1360.0^2 + 412.39^2) ) - log(1000.0) )
            δz1 = Z1p0 - μz1
        else
            δz1 = 0.0
        end
        Fδz1 = 0.0
        if T >= 0.65
            if δz1 <= f7[tid]/f6[tid]
                Fδz1 = f6[tid]*δz1
            else
                Fδz1 = f7[tid]
            end
        end
        # overall site response
        FS = lnFlin + lnFnl + Fδz1

        lnSa = FE + FP + FS
        Sa = exp(lnSa)

        # between-event variability
        if M <= 4.5
            τ = τ1[tid]
        elseif M < 5.5
            τ = τ1[tid] + (τ2[tid] - τ1[tid])*(M - 4.5)
        else
            τ = τ2[tid]
        end

        # within-event variability
        # magnitude dependence
        if M <= 4.5
            ϕM = ϕ1[tid]
        elseif M < 5.5
            ϕM = ϕ1[tid] + (ϕ2[tid] - ϕ1[tid])*(M - 4.5)
        else
            ϕM = ϕ2[tid]
        end
        # distance dependence
        if Rjb <= R1[tid]
            ϕMR = ϕM
        elseif Rjb <= R2[tid]
            ϕMR = ϕM + ΔϕR[tid]*log(Rjb/R1[tid])/log(R2[tid]/R1[tid])
        else
            ϕMR = ϕM + ΔϕR[tid]
        end
        # Vs30 dependence
        if Vs30 <= V1[tid]
            ϕ = ϕMR - ΔϕV[tid]
        elseif Vs30 <= V2[tid]
            ϕ = ϕMR - ΔϕV[tid]*log(V2[tid]/Vs30)/log(V2[tid]/V1[tid])
        else
            ϕ = ϕMR
        end

        σ = sqrt( ϕ^2 + τ^2 )

    else
        bssaLO = PJSbssa2014( Ti[tidLO], M, Rjb, Fss, Fnm, Frv, Fuk, Vs30, Z1p0, region )
        bssaHI = PJSbssa2014( Ti[tidHI], M, Rjb, Fss, Fnm, Frv, Fuk, Vs30, Z1p0, region )

        lnSa = bssaLO.lnSa + log(T/Ti[tidLO])/log(Ti[tidHI]/Ti[tidLO])*(bssaHI.lnSa-bssaLO.lnSa)
		Sa = exp( lnSa )

		τ = bssaLO.τ + log(T/Ti[tidLO])/log(Ti[tidHI]/Ti[tidLO])*(bssaHI.τ - bssaLO.τ)
		ϕ = bssaLO.ϕ + log(T/Ti[tidLO])/log(Ti[tidHI]/Ti[tidLO])*(bssaHI.ϕ - bssaLO.ϕ)
		σ = bssaLO.σ + log(T/Ti[tidLO])/log(Ti[tidHI]/Ti[tidLO])*(bssaHI.σ - bssaLO.σ)
    end

    gm = PJSgroundMotion(Sa, lnSa, τ, ϕ, σ)
	return gm
end

gm = PJSbssa2014( 0.2, 5.75, 15.0, 1, 0, 0, 0, 350.0, 0.5, "California" )



function PJSbssa2014( Ti::Vector{Float64}, M::Float64, Rjb::Float64, Fss::Int64, Fnm::Int64, Frv::Int64, Fuk::Int64, Vs30::Float64, Z1p0::Float64, region::String="Global" )
	predictions = Array{PJSgroundMotion,1}()
	for T in Ti
		push!(predictions, PJSbssa2014( T, M, Rjb, Fss, Fnm, Frv, Fuk, Vs30, Z1p0, region ))
	end
	return predictions
end


function PJSbssa2014(T::U, rup::Rupture{U}, site::Site{U}) where U<:Real
	Rjb = joyner_boore_distance(rup, site)
	Vs30 = vs30(site)
	Z1p0 = z1p0(site)
	region = (site.region == "California") ? "Global" : site.region
	Fss, Fnm, Frv, Fuk = mechanism(rup)

	gm = PJSbssa2014(T, rup.magnitude, Rjb, Fss, Fnm, Frv, Fuk, Vs30, Z1p0, region )
	return gm
end


function PJSbssa2014(Ti::Vector{U}, rup::Rupture{U}, site::Site{U}) where U<:Real
	predictions = Array{PJSgroundMotion,1}()
	for T in Ti
		push!(predictions, PJSbssa2014(T, rup, site))
	end
	return predictions
end


# using Plots
# pyplot()
#
# Ti = exp10.(range(-2,stop=1,length=101))
#
# preds = PJSbssa2014( Ti, 5.75, 15.0, 1, 0, 0, 0, 760.0, 0.5 )
# Sai = get_spectrum(preds)
#
# plot(Ti, Sai, lab="median", xaxis=:log10, yaxis=:log10)
