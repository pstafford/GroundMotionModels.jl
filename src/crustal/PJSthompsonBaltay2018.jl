
include("PJSgroundMotions.jl")
include("PJSrupture.jl")



function PJStb2018(T::U, M::U, Rp::U, Ztor::U, Fnm::Int, Dip::U ) where U<:Real
    #Â period-dependent coefficients
    Ti = [-1, 0, 0.01, 0.02, 0.03, 0.05, 0.075, 0.1, 0.15, 0.2, 0.25, 0.3, 0.4, 0.5, 0.75, 1, 1.5, 2, 3, 4, 5, 6, 7.5, 10 ]
    pi = [-2, -1.3, -1.3, -1.3, -1.3, -1.3, -1.3, -1.3, -1.3, -1.4, -1.4, -1.4, -1.4, -1.4, -1.5, -1.6, -1.7, -1.8, -1.9, -2, -2.1, -2.1, -2.2, -2.2 ]
    c0 = [0.77605306, -4.634138808, -4.632055348, -4.717745066, -4.613291181, -4.34077585, -4.150436733, -4.116994719, -4.046477179, -3.994302578, -4.025718222, -4.018047908, -4.0777797, -4.169809213, -4.482912845, -5.009341378, -5.718108259, -6.295827241, -7.317005227, -8.00642411, -8.638713756, -8.941579324, -9.381715026, -9.979178123 ]
    cr0 = [-1.691654307, -1.661230875, -1.659029571, -1.707432697, -1.723537135, -1.695106761, -1.603678724, -1.494680263, -1.34581779, -1.280594774, -1.259957913, -1.264896932, -1.265431583, -1.288253209, -1.337642078, -1.321024441, -1.376766678, -1.438940251, -1.550975664, -1.624938796, -1.677730466, -1.760984017, -1.855577594, -1.956590798 ]
    cr1 = [0.051820365, 0.079398313, 0.079398313, 0.088787971, 0.088630315, 0.081571735, 0.071058045, 0.05863196, 0.037535246, 0.025047729, 0.020313285, 0.018522521, 0.018376857, 0.017670614, 0.018395317, 0.018293323, 0.028099588, 0.041318207, 0.077854074, 0.101047994, 0.118501349, 0.131505522, 0.146122111, 0.163386746 ]
    cr2 = [-0.001184694, -0.00725845, -0.007300961, -0.007403678, -0.007603229, -0.008567532, -0.009583738, -0.0097611, -0.009054525, -0.007917977, -0.007017786, -0.006114402, -0.004927469, -0.00377335, -0.001997139, -0.001511755, -0.001, -0.001, -0.001, -0.001429589, -0.001437946, -0.001, -0.001, -0.001 ]
    cm1 = [0.512020423, 0.576225551, 0.576225551, 0.580729523, 0.593920554, 0.621571039, 0.652235368, 0.678651325, 0.722974871, 0.759348419, 0.790091106, 0.816709458, 0.861196192, 0.897546106, 0.967814179, 1.021427373, 1.103058902, 1.165772026, 1.26169136, 1.334928137, 1.394297768, 1.444477268, 1.507947031, 1.593129355 ]
    cm2 = [3.527911915, 2.121657347, 2.121657347, 1.86002743, 1.851380227, 2.013697052, 2.252671371, 2.458445001, 2.905597888, 3.29853109, 3.572087068, 3.833284925, 4.262350169, 4.461937328, 4.720947363, 4.859351916, 4.984908086, 5.021946001, 5.043811403, 5.042133653, 5.02181428, 4.995371604, 4.954463052, 4.88275097 ]
    cz1 = [0.027074654, 0.0659707, 0.06687428, 0.066454921, 0.069781354, 0.077535579, 0.078782505, 0.070188513, 0.052306491, 0.037839908, 0.028731109, 0.023847678, 0.021073538, 0.013339528, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ]
    cd1 = [0.728916075, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.158508301, 0.49790766, 0.875852595, 1.093672475, 1.388098196, 1.594055065, 1.742368589, 1.861830429, 2.010312888, 2.198113964 ]
    cf1 = [-0.322389021, -0.322389021, -0.322389021, -0.322389021, -0.322389021, -0.322389021, -0.322389021, -0.322389021, -0.322389021, -0.322389021, -0.322389021, -0.322389021, -0.322389021, -0.322389021, -0.322389021, -0.322389021, -0.322389021, -0.322389021, -0.322389021, -0.322389021, -0.322389021, -0.322389021, -0.322389021, -0.322389021 ]
    ch1 = [0.823085779, 0.823085779, 0.823085779, 0.823085779, 0.823085779, 0.823085779, 0.823085779, 0.823085779, 0.823085779, 0.823085779, 0.823085779, 0.823085779, 0.823085779, 0.823085779, 0.823085779, 0.823085779, 0.823085779, 0.823085779, 0.823085779, 0.823085779, 0.823085779, 0.823085779, 0.823085779, 0.823085779 ]
    p1 = [0.6407, 0.7257, 0.7266, 0.7288, 0.7373, 0.7612, 0.7744, 0.7762, 0.7767, 0.7632, 0.7405, 0.7211, 0.6866, 0.6668, 0.6199, 0.5951, 0.5639, 0.5585, 0.5451, 0.5363, 0.5286, 0.5313, 0.5104, 0.4654 ]
    p2 = [0.1038, 0.16, 0.16, 0.16, 0.16, 0.16, 0.16, 0.16, 0.16, 0.1421, 0.1168, 0.0931, 0.0594, 0.0289, -0.039, -0.0743, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1, -0.1 ]
    t1 = [0.3837, 0.4136, 0.4147, 0.4143, 0.4276, 0.4736, 0.5042, 0.4973, 0.4535, 0.4079, 0.3775, 0.3665, 0.3721, 0.3933, 0.4388, 0.4421, 0.4645, 0.4996, 0.5176, 0.5313, 0.5886, 0.5952, 0.5671, 0.5213 ]
    t2 = [0.081, 0.081, 0.081, 0.081, 0.081, 0.081, 0.081, 0.081, 0.081, 0.081, 0.081, 0.081, 0.081, 0.081, 0.081, 0.081, 0.081, 0.081, 0.081, 0.081, 0.081, 0.081, 0.0519, -0.0584 ]
